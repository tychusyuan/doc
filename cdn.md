# cdn
CDN叠加在承载物理网络之上，在网络边缘利用存储-转发机制就近为用户提供内容分发服务，降低城域网和骨干网传输带宽压力，提升用户体验。用户的服务调度和内容的缓存分发是CDN的灵魂，是评价CDN优劣的主要标准。

## 调度系统
### slb
#### 传输层调度
SLB支持根据传输层信息五元组（源IP、源端口、目标IP、目标端口、协议）按流进行服务调度，将请求前转到最合适的缓存设备，由缓存设备通过三角路由方式将数据直接提供给终端而无需经SLB转发从而降低SLB服务压力。
根据场景的需要，亦可从五元组中选择不同的元素组合构建不同的调度规则。例如采用两元组（源IP、目标IP），应对同一个服务会话中既有TCP控制通道又有UDP数据传输通道的应用场景。
#### 应用层调度
SLB支持七层负载均衡调度和应用层重定向调度（DNS/RTSP/HTTP）。

　　七层负载均衡调度：根据终端请求中的URL、协议头部等应用层信息作为条件来实现负载均衡调度。

　　应用层重定向调度：向终端返回应用层重定向响应（如RTSP 302、HTTP 302、或DNS响应等），不响应（Bypass场景时）或响应为供服务的缓存设备地址和/或URL。
### gslb
#### DNS ns调度
GSLB接收到Local DNS发送的DNS CNAME请求、或Local DNS通过DNS Forward功能前转的DNS请求时，可将其业务加速域名的解析权下放到最合适节点的SLB上，尤其选择合适缓存设备提供服务。
#### 应用层重定向调度
GSLB接收到终端的服务请求或Local DNS通过DNS Forward功能前转的DNS请求时，可将其通过应用层重定向（如 RTSP/HTTP 302或DNS响应等）将其调度到合适的节点SLB上。
### 异域调度
异域Smart Routing调度机制，可应用于多套CDN间的服务调度，提高业务可靠性和实现CDN的互补。例如CP对自建和租用的多套CDN的优选或电信运营商建设的多套异厂商CDN的优选。
### 调度策略
　除传统的地域调度、优先级调度、权重调度、黑白名单过滤、健康调度、负载调度、互助调度等策略，还支持如下高级策略。

#### 业务域调度：
将不同业务请求调度到提供该业务的节点/CDN进行服务；

#### 内容类别调度：
根据内容类别（点直播、是否收费、是否正片）等将请求调度到合适的节点/CDN提供服务；

#### 服务质量调度：
根据网络探针、用户服务话单、或其他方式获得的精确的或大致的业务质量情况将服务请求调度至最合适的节点/CDN；

#### NSP调度：
根据终端所属的NSP（网络服务提供商）将其调度到该NSP内的节点/CDN中提供服务；

#### 时段调度：
根据服务的时间段将请求调度到相应的节点/CDN；

#### 成本调度：
根据节点/CDN的成本将请求调度到合适的节点或CDN提供服务。
## 智能缓存与分发
基于内容、体验、安全三个维度的智能缓存与分发
### 基于内容
#### 动态组播：
能够根据大数据实时统计的内容访问热度，动态将单播传输的热点频道进行组播传输、将热点点播内容动态组播预推到终端，降低骨干网带宽和服务器负荷压力；

#### 分片缓存：
根据用户对内容不同部分访问热度不同的使用习惯，将大文件进行分片，把前5分钟的部分内容预先分发到边缘节点，在保障用户体验质量的同时，尽量提高节点命中率和存储使用效率；另外，当节点内容存储硬盘损坏时，可仅重新分发损坏部分的分片而无需整个大文件全部重新分发，提高分发效率，降低骨干网带宽和服务器负荷压力；

#### 智能预推：
将TOP N热点内容自动预先PUSH/PULL到边缘节点，更新边缘节点的存储，提高命中率，且在分发时采取相应的流控措施防止影响用户服务；

#### 智能缓存：
针对各个CP对内容资源访问URL格式不统一，甚至众多CP自身内部对同一个内容资源的访问URL也多种多样，内容重复缓存会造成存储使用效率低下，需要配置准确的缓存规则。缓存规则自动化智能分析解，通过对服务请求URL的智能化自动分析，完成缓存规则的快速、自动配置，实现内容的智能缓存。
### 基于体验
配和码率平滑，实现内容的最佳分发；

#### QoS差异化控制：
支持与SDN、PCRF等网元的对接，根据用户、内容、CP实现内容分发时的QoS差异化控制。
### 基于安全
除传统的地域阻止、防盗链、二次认证等功能之外，CDN系统还提供如下基于安全维度的内容分发：

#### 智能分析：
海量内容的合规性监管是业界一大难题，支持关键词过滤和图片/视频实时动态智能鉴黄、鉴爆，发现违规即向CDN信息安全管理系统或第三方可信平台报警并停止内容的分发；

#### 点直播防篡改：
提供完善的点播、直播防篡改功能，所有点播内容非授权用户、进程无法篡改，直播内容一旦发现篡改既可启动报警并一键阻断。